<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="Nginx Tcp 转发保留客户端真实 IP （PROXY Protocol）"><meta itemprop=description content="由于在家里搭建了博客，Git 等服务， 经过了阿里云用 Nginx 做了 TCP Proxy, 导致了一个问题，家里看到的服务访问 IP 都是转发服务器的 IP，无法看到真实IP。联想到平常 LB 上的是支持 PROXY Protocol 转发真实IP, 于是搜了一下，Nginx 还真支持！"><meta itemprop=datePublished content="2021-12-18T22:13:59+08:00"><meta itemprop=dateModified content="2021-12-18T22:13:59+08:00"><meta itemprop=wordCount content="859"><meta itemprop=image content="https://razeencheng.com/android-chrome-192x192.png"><meta itemprop=keywords content="nginx,homelib,"><meta property="og:title" content="Nginx Tcp 转发保留客户端真实 IP （PROXY Protocol）"><meta property="og:description" content="由于在家里搭建了博客，Git 等服务， 经过了阿里云用 Nginx 做了 TCP Proxy, 导致了一个问题，家里看到的服务访问 IP 都是转发服务器的 IP，无法看到真实IP。联想到平常 LB 上的是支持 PROXY Protocol 转发真实IP, 于是搜了一下，Nginx 还真支持！"><meta property="og:type" content="article"><meta property="og:url" content="https://razeencheng.com/posts/nginx-tcp-stream-proxy-keep-real-client-ip/"><meta property="og:image" content="https://razeencheng.com/android-chrome-192x192.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-18T22:13:59+08:00"><meta property="article:modified_time" content="2021-12-18T22:13:59+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://razeencheng.com/android-chrome-192x192.png"><meta name=twitter:title content="Nginx Tcp 转发保留客户端真实 IP （PROXY Protocol）"><meta name=twitter:description content="由于在家里搭建了博客，Git 等服务， 经过了阿里云用 Nginx 做了 TCP Proxy, 导致了一个问题，家里看到的服务访问 IP 都是转发服务器的 IP，无法看到真实IP。联想到平常 LB 上的是支持 PROXY Protocol 转发真实IP, 于是搜了一下，Nginx 还真支持！"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=mask-icon href=/safari-pinned-tab.svg><link rel=manifest crossorigin=use-credentials href=/site.webmanifest><link rel="shortcut icon" href=/favicon.ico><title>Nginx Tcp 转发保留客户端真实 IP （PROXY Protocol）</title><link rel=stylesheet href=https://razeencheng.com/css/style.min.a88782436067f84711b02510e9f09bd68bd49c25cd2e03624cd7320fa893b6ea.css integrity="sha256-qIeCQ2Bn+EcRsCUQ6fCb1ovUnCXNLgNiTNcyD6iTtuo=" crossorigin=anonymous></head><body id=page><header id=site-header><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://razeencheng.com>Razeen`s Blog</a></div><nav class="site-nav hide-in-mobile"><a href=https://razeencheng.com/posts/>文章</a>
<a href=https://razeencheng.com/tags/>标签</a>
<a href=https://razeencheng.com/categories/>分类</a>
<a href=https://razeencheng.com/about/>关于</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-social hide-in-mobile"><a href=https://twitter.com/razeencheng target=_blank rel="noopener me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://github.com/razeencheng target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></span><button id=menu-btn class=hdr-btn title=菜单><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://razeencheng.com/posts/>文章</a></li><li><a href=https://razeencheng.com/tags/>标签</a></li><li><a href=https://razeencheng.com/categories/>分类</a></li><li><a href=https://razeencheng.com/about/>关于</a></li></ul></div><main class="site-main section-inner"><article class=thin><header class=post-header><div class=post-meta><span>Dec 18, 2021</span></div><h1>Nginx Tcp 转发保留客户端真实 IP （PROXY Protocol）</h1></header><div class=content><p>由于在家里搭建了博客，Git 等服务， 经过了阿里云用 Nginx 做了 TCP Proxy, 导致了一个问题，家里看到的服务访问 IP 都是转发服务器的 IP，无法看到真实IP。联想到平常 LB 上的是支持 PROXY Protocol 转发真实IP, 于是搜了一下，Nginx 还真支持！</p><h3 id=proxy-protocol>PROXY Protocol<a href=#proxy-protocol class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>什么是 PROXY Protocol ? 其实很简单，就是为了解决多层NET或TCP转发时 无法获取客户端真实IP的问题，在 TCP 第一行加入了一些信息标识协议、客户端地址、转发地址以及端口等。目前有 v1 和 v2 两个版本。</p><h4 id=v1-格式如下>v1 格式如下：<a href=#v1-格式如下 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># PROXY 传输协议 客户端IP 目标IP 客户端端口 目标端口</span>
</span></span><span class=line><span class=cl>PROXY_STRING + single space + INET_PROTOCOL + single space + CLIENT_IP + single space + PROXY_IP + single space + CLIENT_PORT + single space + PROXY_PORT + <span class=s2>&#34;\r\n&#34;</span>
</span></span></code></pre></div><p><strong>示例</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># IPV4</span>
</span></span><span class=line><span class=cl>PROXY TCP4 198.51.100.22 203.0.113.7 <span class=m>35646</span> 80<span class=se>\r\n</span>
</span></span><span class=line><span class=cl><span class=c1># IPV6</span>
</span></span><span class=line><span class=cl>PROXY TCP6 2001:DB8::21f:5bff:febf:ce22:8a2e 2001:DB8::12f:8baa:eafc:ce29:6b2e <span class=m>35646</span> 80<span class=se>\r\n</span>
</span></span><span class=line><span class=cl><span class=c1># 未知</span>
</span></span><span class=line><span class=cl>PROXY UNKNOWN<span class=se>\r\n</span>
</span></span></code></pre></div><h4 id=v2-格式如下>v2 格式如下:<a href=#v2-格式如下 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><ul><li><p>12 字节固定签名</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=se>\x</span>0D<span class=se>\x</span>0A<span class=se>\x</span>0D<span class=se>\x</span>0A<span class=se>\x</span>00<span class=se>\x</span>0D<span class=se>\x</span>0A<span class=se>\x</span>51<span class=se>\x</span>55<span class=se>\x</span>49<span class=se>\x</span>54<span class=se>\x</span>0A
</span></span></code></pre></div></li><li><p>13字节包含协议版本和命令</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 版本</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=c1># 命令</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>0</span>  <span class=c1># LOCAL ，客户段直连</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>1</span>  <span class=c1># PROXY ，进过转发</span>
</span></span></code></pre></div></li><li><p>第 14 个字节包含传输协议和地址族</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 传输协议</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>0</span> <span class=c1># AF_UNSPEC</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>1</span> <span class=c1># AF_INET  (IPv4)</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>2</span> <span class=c1># AF_INET6 (IPv6)</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>3</span> <span class=c1># AF_UNIX  (UNIX)</span>
</span></span><span class=line><span class=cl><span class=c1># 地址族</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>0</span> <span class=c1># UNSPEC</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>1</span> <span class=c1># STREAM  (如：TCP 或 UNIX_STREAM)</span>
</span></span><span class=line><span class=cl><span class=se>\x</span><span class=m>2</span> <span class=c1># DGRAM   (如：UDP 或 UNIX_DGRAM)</span>
</span></span></code></pre></div></li><li><p>第15、16字节为长度标记（剩下的报头长度）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp># 前面的结构
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=k>struct</span> <span class=nc>proxy_hdr_v2</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=kt>uint8_t</span> <span class=n>sig</span><span class=p>[</span><span class=mi>12</span><span class=p>];</span> <span class=cm>/* 十六进制 0D 0A 0D 0A 00 0D 0A 51 55 49 54 0A */</span> 
</span></span><span class=line><span class=cl>        <span class=kt>uint8_t</span> <span class=n>ver_cmd</span><span class=p>;</span> <span class=cm>/* 协议版本和命令 */</span> 
</span></span><span class=line><span class=cl>        <span class=kt>uint8_t</span> <span class=n>fam</span><span class=p>;</span> <span class=cm>/* 协议族和地址 */</span> 
</span></span><span class=line><span class=cl>        <span class=kt>uint16_t</span> <span class=n>len</span><span class=p>;</span> <span class=cm>/* 头的后续字节数 */</span> 
</span></span><span class=line><span class=cl>    <span class=p>};</span> 
</span></span></code></pre></div></li><li><p>接下来就是</p><ul><li>源第三层地址</li><li>目标第三层地址</li><li>源第四层地址（如果有）</li><li>目标第四层地址（如果有）</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl>  <span class=k>union</span> <span class=nc>proxy_addr</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=p>{</span> <span class=cm>/* for TCP/ UDP over IPv4, len = 12 */</span> 
</span></span><span class=line><span class=cl>            <span class=kt>uint32_t</span> <span class=n>src_addr</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>            <span class=kt>uint32_t</span> <span class=n>dst_addr</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>            <span class=kt>uint16_t</span> <span class=n>src_port</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>            <span class=kt>uint16_t</span> <span class=n>dst_port</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=n>ipv4_addr</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=p>{</span> <span class=cm>/* for TCP/UDP over IPv6, len = 36 */</span> 
</span></span><span class=line><span class=cl>             <span class=kt>uint8_t</span> <span class=n>src_addr</span><span class=p>[</span><span class=mi>16</span><span class=p>];</span> 
</span></span><span class=line><span class=cl>             <span class=kt>uint8_t</span> <span class=n>dst_addr</span><span class=p>[</span><span class=mi>16</span><span class=p>];</span> 
</span></span><span class=line><span class=cl>             <span class=kt>uint16_t</span> <span class=n>src_port</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>             <span class=kt>uint16_t</span> <span class=n>dst_port</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=n>ipv6_addr</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=k>struct</span> <span class=p>{</span> <span class=cm>/* 对于 AF_UNIX 套接字，len = 216 */</span> 
</span></span><span class=line><span class=cl>             <span class=kt>uint8_t</span> <span class=n>src_addr</span><span class=p>[</span><span class=mi>108</span><span class=p>];</span> 
</span></span><span class=line><span class=cl>             <span class=kt>uint8_t</span> <span class=n>dst_addr</span><span class=p>[</span><span class=mi>108</span><span class=p>];</span> 
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=n>unix_addr</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>    <span class=p>};</span> 
</span></span></code></pre></div></li></ul><p>但，要开启 PROXY Protocol , 必须在转发器和服务端同时支持该协议， 很庆幸 Nginx 早就支持了。</p><ul><li>开源版本 v1.5.12 以及之后支持v1； v1.13.11以及之后支持v2。</li></ul><h3 id=配置>配置<a href=#配置 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>首先转发服务上 <code>stream</code> 和 <code>stream_realip_module</code> 模块肯定要编译到 Nginx 中去，服务端<code>http_realip_module</code>也要编辑进去。</p><p>然后，简单配置如下：</p><p><strong>转发服务</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>stream</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kn>map</span> <span class=nv>$remote_addr</span> <span class=nv>$homeserv</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>default</span>  <span class=n>h.razeen.cn</span><span class=p>:</span><span class=mi>50080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kn>resolver</span> <span class=mi>223</span><span class=s>.5.5.5</span> <span class=s>valid=15s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_pass</span> <span class=nv>$homeserv</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_protocol</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>服务端</strong></p><p>服务端通过<code>proxy_protocol_addr</code>就能拿到真实IP了，于是我们可以通过Header转发到对应后面的服务。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span>                       <span class=mi>50080</span> <span class=s>proxy_protocol</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>X-Real-IP</span>       <span class=nv>$proxy_protocol_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_protocol_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=kn>....</span>
</span></span><span class=line><span class=cl>	<span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></div><p>这样就大功告成，成功通过Nginx TCP Proxy 获取真实客户端IP～</p><h3 id=参考>参考<a href=#参考 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><ul><li>[1] <a href=https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt>The PROXY protocol</a></li><li>[2] <a href=https://docs.nginx.com/nginx/admin-guide/load-balancer/using-proxy-protocol/>Accepting the PROXY Protocol</a></li></ul></div><div class="related-posts thin"><h2>相关推荐</h2><ul><li><a href=/posts/homelib-007-set-ipsec-vpn-client/>Homelib (7)：IPSec VPN（基于证书认证）客户端设置</a></li><li><a href=/posts/homelib-006-build-ipsec-vpn/>Homelib (6)： 基于自签发证书的 IPSec VPN 搭建</a></li><li><a href=/posts/homelib-005-ddns/>Homelib (5)： DDNS 动态域名解析</a></li><li><a href=/posts/homelib-004-prepare-the-server-environment/>Homelib (4)： Linux 服务器基础环境准备</a></li><li><a href=/posts/homelib-003-network-topology-and-hardware/>Homelib (3)： 整体网络与基础硬件介绍</a></li></ul></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://razeencheng.com/tags/nginx>nginx</a></span><span class=tag><a href=https://razeencheng.com/tags/homelib>homelib</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>859 字</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2021-12-18 14:13 +0000</p></footer></article><aside id=toc class=show-toc><div class=toc-title>目录</div><nav id=TableOfContents><ul><li><ul><li><a href=#proxy-protocol>PROXY Protocol</a></li><li><a href=#配置>配置</a></li><li><a href=#参考>参考</a></li></ul></li></ul></nav></aside><div class="post-nav thin"><a class=next-post href=https://razeencheng.com/posts/homelib-008-gitlab-and-registry/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;新</span><br><span>Homelib(8): 搭建自用 Gitlab 与 Docker 仓库</span></a>
<a class=prev-post href=https://razeencheng.com/posts/homelib-007-set-ipsec-vpn-client/><span class=post-nav-label>旧&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Homelib (7)：IPSec VPN（基于证书认证）客户端设置</span></a></div><div id=google-ads class=thin><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4450478767591566" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4450478767591566 data-ad-slot=8164928618 data-ad-format=auto data-full-width-responsive=true></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div id=comments class=thin><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//razeen-me.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></main><footer id=site-footer class="section-inner thin"><p>&copy; 2017 - 2022 <a href=https://razeencheng.com>Razeen</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://razeencheng.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://s.razeen.cn/assets/js/mermaid.min.js></script>
<script>Array.from(document.getElementsByClassName("language-mermaid")).forEach(e=>{e.parentElement.outerHTML=`<div class="mermaid">${e.innerText}</div>`})</script><script src=https://razeencheng.com/js/main.min.4e6345981f1ff315bbb7afa61eacf413923b536e5a4d5b22f698d96b624d48c4.js integrity="sha256-TmNFmB8f8xW7t6+mHqz0E5I7U25aTVsi9pjZa2JNSMQ=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4BKH11NSEY"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4BKH11NSEY")</script></body></html>