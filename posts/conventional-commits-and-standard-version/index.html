<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="规范 git commit message 与自动化版本控制"><meta itemprop=description content="git commit message是你对你所编码内容的总结概括。规范、详细的git commit message不仅能体现你的内容概括能力，还能为你自己和团队，或项目带来巨大的好处，这也是我所推崇的。但很多小伙伴不愿意花时间在这里，经常会写出优化了一些功能、修复了一些BUG等等模糊不清的commit message，完全没有意识到这么写会带来一些严重的问题：

管理者/其他项目参与者无法快速获取有用信息，判定修改内容，只有花大量时间阅读源码；
事后无法快速定位以前遇到的类似问题；
无法自动化版本控制，只有每次重新阅读代码，手动写一些详细的描述，用来发布新版或提交测试。

规范、详细的git commit message不仅能解决这些问题，还能带来更多的好处。"><meta itemprop=datePublished content="2020-04-12T23:27:53+00:00"><meta itemprop=dateModified content="2020-04-12T23:27:53+00:00"><meta itemprop=wordCount content="1832"><meta itemprop=image content="https://razeencheng.com/android-chrome-192x192.png"><meta itemprop=keywords content="git,standard-version,"><meta property="og:title" content="规范 git commit message 与自动化版本控制"><meta property="og:description" content="git commit message是你对你所编码内容的总结概括。规范、详细的git commit message不仅能体现你的内容概括能力，还能为你自己和团队，或项目带来巨大的好处，这也是我所推崇的。但很多小伙伴不愿意花时间在这里，经常会写出优化了一些功能、修复了一些BUG等等模糊不清的commit message，完全没有意识到这么写会带来一些严重的问题：

管理者/其他项目参与者无法快速获取有用信息，判定修改内容，只有花大量时间阅读源码；
事后无法快速定位以前遇到的类似问题；
无法自动化版本控制，只有每次重新阅读代码，手动写一些详细的描述，用来发布新版或提交测试。

规范、详细的git commit message不仅能解决这些问题，还能带来更多的好处。"><meta property="og:type" content="article"><meta property="og:url" content="https://razeencheng.com/posts/conventional-commits-and-standard-version/"><meta property="og:image" content="https://razeencheng.com/android-chrome-192x192.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-12T23:27:53+00:00"><meta property="article:modified_time" content="2020-04-12T23:27:53+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://razeencheng.com/android-chrome-192x192.png"><meta name=twitter:title content="规范 git commit message 与自动化版本控制"><meta name=twitter:description content="git commit message是你对你所编码内容的总结概括。规范、详细的git commit message不仅能体现你的内容概括能力，还能为你自己和团队，或项目带来巨大的好处，这也是我所推崇的。但很多小伙伴不愿意花时间在这里，经常会写出优化了一些功能、修复了一些BUG等等模糊不清的commit message，完全没有意识到这么写会带来一些严重的问题：

管理者/其他项目参与者无法快速获取有用信息，判定修改内容，只有花大量时间阅读源码；
事后无法快速定位以前遇到的类似问题；
无法自动化版本控制，只有每次重新阅读代码，手动写一些详细的描述，用来发布新版或提交测试。

规范、详细的git commit message不仅能解决这些问题，还能带来更多的好处。"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=mask-icon href=/safari-pinned-tab.svg><link rel=manifest crossorigin=use-credentials href=/site.webmanifest><link rel="shortcut icon" href=/favicon.ico><title>规范 git commit message 与自动化版本控制</title><link rel=stylesheet href=https://razeencheng.com/css/style.min.a88782436067f84711b02510e9f09bd68bd49c25cd2e03624cd7320fa893b6ea.css integrity="sha256-qIeCQ2Bn+EcRsCUQ6fCb1ovUnCXNLgNiTNcyD6iTtuo=" crossorigin=anonymous></head><body id=page><header id=site-header><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://razeencheng.com>Razeen`s Blog</a></div><nav class="site-nav hide-in-mobile"><a href=https://razeencheng.com/posts/>文章</a>
<a href=https://razeencheng.com/tags/>标签</a>
<a href=https://razeencheng.com/categories/>分类</a>
<a href=https://razeencheng.com/about/>关于</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-social hide-in-mobile"><a href=https://twitter.com/razeencheng target=_blank rel="noopener me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://github.com/razeencheng target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></span><button id=menu-btn class=hdr-btn title=菜单><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://razeencheng.com/posts/>文章</a></li><li><a href=https://razeencheng.com/tags/>标签</a></li><li><a href=https://razeencheng.com/categories/>分类</a></li><li><a href=https://razeencheng.com/about/>关于</a></li></ul></div><main class="site-main section-inner"><article class=thin><header class=post-header><div class=post-meta><span>Apr 12, 2020</span></div><h1>规范 git commit message 与自动化版本控制</h1></header><div class=content><p>git commit message是你对你所编码内容的总结概括。规范、详细的git commit message不仅能体现你的内容概括能力，还能为你自己和团队，或项目带来巨大的好处，这也是我所推崇的。但很多小伙伴不愿意花时间在这里，经常会写出<code>优化了一些功能</code>、<code>修复了一些BUG</code>等等模糊不清的commit message，完全没有意识到这么写会带来一些严重的问题：</p><ul><li>管理者/其他项目参与者无法快速获取有用信息，判定修改内容，只有花大量时间阅读源码；</li><li>事后无法快速定位以前遇到的类似问题；</li><li>无法自动化版本控制，只有每次重新阅读代码，手动写一些详细的描述，用来发布新版或提交测试。</li></ul><p>规范、详细的git commit message不仅能解决这些问题，还能带来更多的好处。</p><ul><li><p>提供详细的历史信息，方便快速浏览，不用花大量时间阅读源码；</p></li><li><p>提供高效的团队合作，参与者能从提交信息中看到项目的进度；</p></li><li><p>可以快读定位问题，如果现在出现一个BUG，可以从BUG的类型，通过提交信息快读定位可能是哪次修改带来的；</p></li><li><p>可以直接从commit中总结周报，日报，项目报告；</p></li><li><p>可以直接从commit生成CHANGELOG;</p></li><li><p>影响团队其他成员，培养大家养成良好的习惯。</p></li></ul><p>下面我们推荐一个git commit message书写规范，以及如何通过commit message自动完成版本控制，生成CHANGELOG。</p><h3 id=规范>规范<a href=#规范 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>我们严格遵循<a href=https://www.conventionalcommits.org/en/v1.0.0-beta.4/><code>Conventional Commits</code></a> 的约定，详细内容可以点击链接查看，下面我们简单总结一下。</p><p>commit messge格式如下：</p><pre tabindex=0><code class=language-git data-lang=git>&lt;type&gt;[optional scope]: &lt;description&gt;

[optional body]

[optional footer]
</code></pre><p>我们先举几个例子，再详细解析这个格式，如下：</p><pre tabindex=0><code>feat(xxx): 新增了xxx功能，实现了xxx 
BREAKING CHANGE: 我们需要切换到V2了
fix(comment): 修复多用户评论时，顺序错乱问题
feat(comment): 新增用户评论功能
chore(comment): 新增了评论部分的swagger文档
docs(readme): 创建README.md文件
</code></pre><p>是不是不用我解释就懂了，对的就这么简单：</p><ul><li><code>&lt;type></code> : 是指本次提交的类型，一般有<code>feat</code>,<code>fix</code>,<code>chore</code>,<code>docs</code>,<code>style</code>,<code>refactor</code>,<code>perf</code>,<code>test</code>等，这里我推荐使用<code>feat</code>,<code>fix</code>,<code>chore</code>,<code>docs</code>四个，也就先说明这几个，更多的看<a href=https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines>这里</a>。<ul><li><code>feat</code>: 说明本次提交的是一个新的feature;</li><li><code>fix</code>: 修复了一个bug;</li><li><code>chore</code>: 一些没有构成feature, 但又不是其他类型的提交；</li><li><code>docs</code>: 只是修改了文档相关的内容。</li></ul></li><li><code>[optional scope]</code>: 从单词的意思我们不难看出, 这里可以选填一个范围，也就是说，我们可以通过该关键词说明本次提交影响的范围（或许是一个模块，某一个功能，某一个业务等）。</li><li><code>&lt;description></code> : 这里就是我们需要详细的描述本次提交内容的部分了。</li><li><code>[optional body]</code> ,<code>[optional footer]</code> 如果还有需要补充或者详细展开的部分，我们可以在这两个部分说明。</li></ul><h3 id=自动化版本控制>自动化版本控制<a href=#自动化版本控制 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>有了规划化的提交后，我们就可以利用<a href=https://github.com/conventional-changelog/standard-version><code>standard-version</code></a>实现自动化版本控制与CHANGELOG自动生成了。</p><p>首先，我们全局安装一下<code>standard-version</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm install -g standard-version
</span></span></code></pre></div><p>安装完成，可以查看一下版本，推荐一个团队最好使同一个大版本，避免一些奇怪的问题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>standard-version --version
</span></span></code></pre></div><p>当然，你也可以直接安装指定版本。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm install -g standard-version@7.1.0
</span></span></code></pre></div><p>有了规范的提交与<code>standard-version</code> 后，我们就可以愉快的进行版本控制和自动生成CHANGELOG了，只需要每次提交之后，在你的项目下面运行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>standard-version
</span></span></code></pre></div><p>即可。</p><p>我们很容易想到，<code>standard-version</code>可能会将git commit message, 自动整理生成CHANGELOG。 但版本升级怎么做到，规则是怎么样的呢？</p><p>这就取决于上面的git commit message中的<code>type</code>了。</p><ul><li>其中 <code>fix</code>对应于语义版本<code>patch</code>, 白话一点就是升级<code>0.0.1</code>个版本；</li><li><code>feat</code>对应于与<code>minor</code>，也就是升级<code>0.1.0</code>个版本；</li></ul><p>那么怎么实现从<code>1.0.0 </code>到<code>2.0.0</code>呢，也就是改变<code>major</code>版本呢？</p><ul><li><p>其实只要在任何类型commit message后面的<code>[optional body]</code>或<code>[optional footer]</code>部分，以**BREAKING CHANGE: ** 开头，写一些版本升级的内容即可，如：</p><pre tabindex=0><code>feat(xxx): 新增了xxx功能，实现了xxx 
BREAKING CHANGE: xxxxxx
</code></pre></li></ul><blockquote><p>这里我们补充点<a href=https://semver.org/#summary>语义版本控制</a>的内容。</p><p>通常我们看到的版本是这样的：<code>1.1.1</code> 、<code>1.0.0-beta.11</code> 或者 <code>1.0.0-rc</code> ，其实这种写法就是遵循语义化版本规范的，详细内容可以点上面链接查看，我们主要说明一下核心语法，即：</p><pre tabindex=0><code>&lt;version core&gt; ::= &lt;major&gt; &#34;.&#34; &lt;minor&gt; &#34;.&#34; &lt;patch&gt;
</code></pre><p>也就是版本 <code>1.2.3</code>，主版本号为1，次要版本为2，补丁号为3.</p></blockquote><p>到这里你应该对规范化的git commit message有所了解，以及知道通过<code>standard-version</code>控制版本与自动生成CHANGELOG了。希望能对你有所帮助，养成良好的习惯，从而提高生产效率。</p></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://razeencheng.com/tags/git>git</a></span><span class=tag><a href=https://razeencheng.com/tags/standard-version>standard-version</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1832 字</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2020-04-12 23:27 +0000</p></footer></article><aside id=toc class=show-toc><div class=toc-title>目录</div><nav id=TableOfContents><ul><li><ul><li><a href=#规范>规范</a></li><li><a href=#自动化版本控制>自动化版本控制</a></li></ul></li></ul></nav></aside><div class="post-nav thin"><a class=next-post href=https://razeencheng.com/posts/golang-and-git-commit-message-pre-commit/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;新</span><br><span>利用 git hook 规范你的代码与 commit message</span></a>
<a class=prev-post href=https://razeencheng.com/posts/my-macvim-vimrc/><span class=post-nav-label>旧&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>超详细 vim 配置 (with MacVim)</span></a></div><div id=google-ads class=thin><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4450478767591566" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4450478767591566 data-ad-slot=8164928618 data-ad-format=auto data-full-width-responsive=true></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div id=comments class=thin><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//razeen-me.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></main><footer id=site-footer class="section-inner thin"><p>&copy; 2017 - 2022 <a href=https://razeencheng.com>Razeen</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://razeencheng.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://s.razeen.cn/assets/js/mermaid.min.js></script>
<script>Array.from(document.getElementsByClassName("language-mermaid")).forEach(e=>{e.parentElement.outerHTML=`<div class="mermaid">${e.innerText}</div>`})</script><script src=https://razeencheng.com/js/main.min.4e6345981f1ff315bbb7afa61eacf413923b536e5a4d5b22f698d96b624d48c4.js integrity="sha256-TmNFmB8f8xW7t6+mHqz0E5I7U25aTVsi9pjZa2JNSMQ=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4BKH11NSEY"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4BKH11NSEY")</script></body></html>